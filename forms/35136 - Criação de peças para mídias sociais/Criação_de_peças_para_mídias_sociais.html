<!DOCTYPE html>
	<html>
		<head>
			<title>Form</title>

            <link rel="stylesheet" type="text/css" href="/resources/style-guide/css/fluig-style-guide.min.css">
            <script src="/resources/js/jquery/jquery.js"></script>
            <script src="/resources/js/jquery/jquery-ui.min.js"></script>
            <script src="/resources/js/mustache/mustache-min.js"></script>
            <script src="/resources/style-guide/js/fluig-style-guide.min.js"></script>

            <!-- CUSTOM -->
            <link href="/resources/style-guide/css/fluig-style-guide-filter.min.css" rel="stylesheet" type="text/css">
            <link href="/resources/style-guide/css/fluig-style-guide-ratingstars.min.css" rel="stylesheet" type="text/css">
            <script src="/resources/style-guide/js/fluig-style-guide-filter.min.js"></script>
            <script src="/resources/style-guide/js/fluig-style-guide-ratingstars.min.js"></script>

            <link href='/webdesk/customresources?cid=1&resourceName=temaFormulario/0.css' type='text/css' rel='stylesheet' />

            <script type="text/javascript" src="functions.js"></script>
		</head>
        <body class="fluig-style-guide">
			
			<form class="totvs-form grid vertical create-form-components ui-sortable t0" name="createFormComponents" style="padding-top:34px !important; padding-bottom: 34px !important;  padding-left: 20px !important; padding-right: 20px !important; margin-right: 25px !important; margin-left: 25px !important; margin-bottom: 150px !important;">
				<input type="hidden" id="cnpj" name="cnpj" />
				<input type="hidden" id="division" name="division" />
				<input type="hidden" class="form-control" name="avaliado_criacao_nome" value="" placeholder="" data-size="big" maxlength="255" required="required" analytics="true" />
				<input type="hidden" class="form-control" name="avaliador_criacao_nome" value="" placeholder="" data-size="big" maxlength="255" required="required" analytics="true" />
				<input type="hidden" class="form-control" name="avaliado_midia_nome" value="" placeholder="" data-size="big" maxlength="255" required="required" analytics="true" />
				<input type="hidden" class="form-control" name="avaliador_midia_nome" value="" placeholder="" data-size="big" maxlength="255" required="required" analytics="true" />
				<input type="hidden" class="form-control" name="aprovador_urgencia" value="" placeholder="" data-size="big" maxlength="255" required="required" analytics="true" />
				<input type="hidden" name="total_refacao_criacao" value="0" analytics="true" />
				<input type="hidden" name="total_refacao_deriv" value="0" analytics="true" />

				<h1 class="title-form-application">Criação de peças para mídias sociais</h1>

				<div class="row">
					<div class="col-xs-12 col-sm-8">
						<div class="form-field" data-show-properties="" data-field-name="empresa">
							<div class="form-input">
								<div class="form-group">
									<label for="empresa">Empresa:</label><span class="required text-danger"><strong>*</strong></span>
									<input type="zoom"
									    id="empresa"
									    name="empresa"
									    data-zoom="{
									            'displayKey':'empresa',
									            'datasetId':'ds_empresas_v3',
									            'maximumSelectionLength':'1',
									            'resultLimit':5,
									            'placeholder': 	'Selecione a empresa',
									            'filterValues':'metadata_active,true,status,ATIVO',
									            'fields':[
									                {
									                   'field':'id',
									                   'label':'ID'
									                },{
									                  'field':'empresa',
									                  'label':'Nome',
									                  'standard':'true'
									                },{
									                  'field':'cnpj',
									                  'label':'CNPJ'
									                },{
									                  'field':'division',
									                  'label':'DIVISION'
									            	}
									            ]
									         }" />						
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-4">
						<div class="form-field" data-type="combo" data-show-properties="" data-field-name="guide_marca">
							<div class="form-input">
								<div class="form-group">
									<label for="guide_marca">Possui Guide de Marca?</label>
									<span class="required text-danger"><strong>*</strong></span>
									<select class="form-control" name="guide_marca" required="required" gooddataid="2">
										<option value="">Selecione</option>
										<option value="ANEXO">Anexo</option>
										<option value="NÃO">Não</option>
									</select>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="row">
					<div class="col-xs-12 col-sm-6">
						<div class="form-field" data-type="combo" data-show-properties="" data-field-name="midia">
							<div class="form-input">
								<div class="form-group">
									<label for="midia">Selecione a Mídia:</label>
									<span class="required text-danger"><strong>*</strong></span>
									<select id="select_midia" class="form-control" name="midia" required="required" analytics="true" gooddataid="3">
										<option value="">Selecione</option>
										<option value="FACEBOOK">Facebook</option>
										<option value="INSTAGRAM">Instagram</option>
										<option value="LINKEDIN">Linkedin</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6">
						<div id="tipo_peca" class="form-field" data-type="combo" data-show-properties="" data-field-name="tipo_peca">
							<div class="form-input">
								<div class="form-group">
									<label for="tipo_peca">Tipo de Peça:</label>
									<span class="required text-danger"><strong>*</strong></span>
									<select id="select_tipo_peca" class="form-control" name="tipo_peca" required="required" gooddataid="4"></select>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div id="objetivo" class="form-field" data-type="combo" data-show-properties="" data-field-name="objetivo">
					<div class="form-input">
						<div class="form-group">
							<label for="objetivo">Objetivo:</label>
							<span class="required text-danger"><strong>*</strong></span>
							<textarea name="objetivo" class="form-control" placeholder="Descreva alguma ideia ou orientação do que deve ser feito, qual mensagem deverá passar, etc." rows="5"></textarea>
						</div>
					</div>
				</div>

				<div id="referencia_visual" class="form-field" data-type="combo" data-show-properties="" data-field-name="referencia_visual">
					<div class="form-input">
						<div class="form-group">
							<label for="referencia_visual">Referência Visual:</label>
							<textarea name="referencia_visual" class="form-control" placeholder="Cole links, escreva uma ideia ou sinalize anexo." rows="5"></textarea>
						</div>
					</div>
				</div>

				<div id="observacoes" class="form-field" data-type="combo" data-show-properties="" data-field-name="observacoes">
					<div class="form-input">
						<div class="form-group">
							<label for="observacoes">Observações Adicionais:</label>
							<textarea name="observacoes" class="form-control" placeholder="Escreva alguma observação importante." rows="5"></textarea>
						</div>
					</div>
				</div>

				<!-- CAMPOS CUSTOMIZÁVEIS -->

				<div id="texto_orientacao" class="form-field" data-type="combo" data-show-properties="" data-field-name="texto_orientacao">
					<div class="form-input">
						<div class="form-group">
							<label>Texto na Peça</label>
							<span class="required text-danger"><strong>*</strong></span>
							<textarea name="texto_orientacao" class="form-control" placeholder="Escreva o texto presente na peça" rows="5"></textarea>
						</div>
					</div>
				</div>

				<div id="cards" class="table">
					<table id="cards_table" class="table table-condensed" tablename="carrossel" addbuttonlabel="Adicionar Card">
						<thead>
							<tr>
								<th><strong>Texto do Card</strong></th>
								<th><strong>Link Imagem</strong></th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><input type="text" class="form-control" name="texto_card" /></td>
								<td><input type="text" class="form-control" name="link_card"  /></td>
							</tr>
						</tbody>
					</table>
				</div>

				<!-- /CAMPOS CUSTOMIZÁVEIS -->

				<div class="form-field" data-type="combo" data-show-properties="" data-field-name="urgencia">
					<div class="form-input">
						<div class="form-group">
							<label for="urgencia">Pedido Urgente:</label>
							<span class="required text-danger"><strong>*</strong></span>
							<select id="urgencia" class="form-control" name="urgencia" required="required" analytics="true" gooddataid="5">
								<option value="">Selecione</option>
								<option value="SIM">Sim</option>
								<option value="NÃO">Não</option>
							</select>
						</div>
					</div>
				</div>

				<div id="justificativa_urgencia" class="form-field" data-type="combo" data-show-properties="" data-field-name="justificativa_urgencia">
					<div class="form-input">
						<div class="form-group">
							<label for="justificativa_urgencia">Justificativa da Urgência:</label>
							<span class="required text-danger"><strong>*</strong></span>
							<textarea id="txt_justificativa_urgencia" name="justificativa_urgencia" class="form-control" placeholder="Justifique seu pedido" rows="5"></textarea>
						</div>
					</div>
				</div>

				<!-- FIM SOLICITAÇÃO -->

				<div id="aprovacao_urgencia" class="form-field" data-type="combo" data-show-properties="" data-field-name="aprovacao_urgencia">
					<div class="form-input">
						<div class="form-group">
							<label for="aprovacao_urgencia">Aprovação da Urgência:</label>
							<span class="required text-danger"><strong>*</strong></span>
							<select class="form-control" name="aprovacao_urgencia" required="required" analytics="true" gooddataid="6">
								<option value="">Selecione</option>
								<option value="SIM">Sim</option>
								<option value="NÃO">Não</option>
							</select>
						</div>
					</div>
				</div>

				<div id="prazo_canvas" class="row">
					<div class="col-xs-12 col-sm-6">
						<div class="form-field" data-type="combo" data-show-properties="" data-field-name="data_prazo_canvas">
							<div class="form-input">
								<div class="form-group">
									<label for="data_prazo_canvas">Data Prevista:</label>
									<span class="required text-danger"><strong>*</strong></span>
									<input type="text" id="data_prazo_canvas" class="form-control calendar-date" name="data_prazo_canvas" />
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6">
						<div class="form-field" data-type="combo" data-show-properties="" data-field-name="hora_canvas">
							<div class="form-input">
								<div class="form-group">
									<label for="hora_canvas">Hora Prevista:</label>
									<span class="required text-danger"><strong>*</strong></span>
									<input type="text" id="hora_canvas" class="form-control" name="hora_canvas" mask="00:00" placeholder="00:00" />
								</div>
							</div>
						</div>
					</div>
				</div>

				<div id="avl_score_briefing" class="form-field text-center" data-type="ratingstar" data-show-properties="" data-field-name="avl_score_briefing">
					<div class="paragraph-is-required system-message-information alert alert-danger" role="alert"><strong>ATENÇÃO!</strong> Este procedimento é obrigatório para continuidade do processo.</div>
					<div class="form-input">
						<div class="form-group">
							<label>Avalie o Briefing</label>
							<div class="rating fluig-ratingstars custom-fluig-ratingstars">
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
							</div>
							<input type="hidden" name="avl_score_briefing" class="rating-value" required="required" analytics="true" >
						</div>
					</div>

					<div class="form-input">
						<div class="form-group">
							<label for="cmtt_avl_briefing">Comentários</label>
							<textarea id="cmtt_avl_briefing" name="cmtt_avl_briefing" class="form-control"></textarea>
							<p class="help-block">Não se preocupe, essa avaliação não será divulgada.</p>
						</div>
					</div>
				</div>

				<div id="avl_score_criacao" class="form-field text-center" data-type="ratingstar" data-show-properties="" data-field-name="avl_score_criacao">
					<div class="paragraph-is-required system-message-information alert alert-danger" role="alert"><strong>ATENÇÃO!</strong> Este procedimento é obrigatório para continuidade do processo.</div>
					<div class="form-input">
						<div class="form-group">
							<label>Avalie a Criação</label>
							<div class="rating fluig-ratingstars custom-fluig-ratingstars">
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
								<i class="fa fluigicon fluigicon-star-empty fluigicon-sm"></i>
							</div>
							<input type="hidden" name="avl_score_criacao" class="rating-value" required="required" analytics="true" >
						</div>
					</div>

					<div class="form-input">
						<div class="form-group">
							<label for="cmtt_avl_criacao">Comentários</label>
							<textarea id="cmtt_avl_criacao" name="cmtt_avl_criacao" class="form-control"></textarea>
							<p class="help-block">Não se preocupe, essa avaliação não será divulgada.</p>
						</div>
					</div>
				</div>

				<div id="aprovacao_peca" class="form-field" data-type="combo" data-show-properties="" data-field-name="aprovacao_peca">
					<div class="form-input">
						<div class="form-group">
							<label for="aprovacao_peca">Aprovação da Peça:</label>
							<span class="required text-danger"><strong>*</strong></span>
							<select id="select_aprovacao_peca" class="form-control" name="aprovacao_peca" required="required" analytics="true" gooddataid="7">
								<option value="">Selecione</option>
								<option value="SIM">Sim</option>
								<option value="NAO">Refação</option>
							</select>
						</div>
					</div>
				</div>

				<div id="refacao" class="form-field" data-type="combo" data-show-properties="" data-field-name="refacao">
					<div class="form-input">
						<div class="form-group">
							<label>Refação</label>
							<span class="required text-danger"><strong>*</strong></span>
							<textarea name="refacao" class="form-control" placeholder="Escreva os detalhes da refação" rows="5"></textarea>
						</div>
					</div>
				</div>

				<div id="derivacao" class="form-field" data-type="combo" data-show-properties="" data-field-name="derivacao">
					<div class="form-input">
						<div class="form-group">
							<label for="derivacao">Existirá derivação para peça?</label>
							<span class="required text-danger"><strong>*</strong></span>
							<select id="select_derivacao" class="form-control" name="derivacao" required="required" analytics="true" gooddataid="8">
								<option value="">Selecione</option>
								<option value="SIM">Sim</option>
								<option value="NAO">Não - Finalizar</option>
							</select>
						</div>
					</div>
				</div>

				<div id="txt_derivacao" class="form-field" data-type="combo" data-show-properties="" data-field-name="txt_derivacao">
					<div class="form-input">
						<div class="form-group">
							<label>Comentários Derivação</label>
							<span class="required text-danger"><strong>*</strong></span>
							<textarea id="txt_derivacao_field" name="txt_derivacao" class="form-control" placeholder="Escreva os detalhes da derivação" rows="5"></textarea>
						</div>
					</div>
				</div>

				<div id="aprovacao_derivacao" class="form-field" data-type="combo" data-show-properties="" data-field-name="aprovacao_derivacao">
					<div class="form-input">
						<div class="form-group">
							<label for="aprovacao_derivacao">Aprovação da derivação</label>
							<span class="required text-danger"><strong>*</strong></span>
							<select id="sel_aprovacao_derivacao" class="form-control" name="aprovacao_derivacao" required="required" analytics="true" gooddataid="9">
								<option value="">Selecione</option>
								<option value="SIM">Sim - Finalizar</option>
								<option value="NAO">Refação</option>
							</select>
						</div>
					</div>
				</div>


				<div id="derivacao_refacao" class="form-field" data-type="combo" data-show-properties="" data-field-name="derivacao_refacao">
					<div class="form-input">
						<div class="form-group">
							<label>Refação da Derivação:</label>
							<span class="required text-danger"><strong>*</strong></span>
							<textarea id="txt_derivacao_refacao" name="derivacao_refacao" class="form-control" placeholder="Escreva os detalhes da refação da derivação" rows="5"></textarea>
						</div>
					</div>
				</div>


			</form>
		

			<script type="text/javascript">
				var keyDown = false, ctrl = 17, vKey = 86, Vkey = 118; 
				  
				$(document).keydown(function (e) {
					if (e.keyCode == ctrl) keyDown = true;
				}).keyup(function (e) {
					if (e.keyCode == ctrl) keyDown = false;
				});
				
				$('[data-only-numbers]').on('keypress', function (e) {
				    if (!e) {
					    var e = window.event;
					}
					
				    if (e.keyCode > 0 && e.which == 0) {
				    	 return true;
					}
					
				    if (e.keyCode) {
				        code = e.keyCode;
					} else if (e.which) {
				    	code = e.which;
					}

					if(code == 46) {
						return true;
					}
					
				    var character = String.fromCharCode(code);
				    if (character == '\b' || character == ' ' || character == '\t') {
				    	 return true;
					}
				    if (keyDown && (code == vKey || code == Vkey)) {
				    	return (character);
					} else  {
						return (/[0-9]$/.test(character));
					}
				}).on('focusout', function (e) {
				    var $this = $(this);
					if($this.val() == "") {
						return true;
					}
				    $this.val($this.val().replace(/[^0-9\.]/g, ''));
				}).on('paste', function (e) {
				    var $this = $(this);
				    setTimeout(function () {
				        $this.val($this.val().replace(/[^0-9\.]/g, ''));
				    }, 5);
				 });		

				

				$('.create-form-components').on('keyup', 'input[required="required"][type="text"], input[required="required"][type="number"], input[required="required"][type="date"], textarea[required="required"]', function(){
					validationFieldsForm($(this), $(this).parents('.form-field').data('type'));
				});

				$('.create-form-components').on('change', 'input[required="required"][type="checkbox"], input[required="required"][type="radio"], select[required="required"]', function(){
					validationFieldsForm($(this), $(this).parents('.form-field').data('type'));
				});

				function validationFieldsForm(field, type){
					if(type === "checkbox" || type === "radio"){
						if(!field.is(':checked')){
							field.parents('.form-field').addClass('required');
						}else{
							field.parents('.form-field').removeClass('required');
						}
					}else{
						if(!field.val().trim()){
							field.parents('.form-field').addClass('required');
						}else{
							field.parents('.form-field').removeClass('required');
						}
					}
				}

				var $zoomPreview = $(".zoom-preview");
				if ($zoomPreview.length) {
                    $zoomPreview.parent().removeClass("input-group");
                    $zoomPreview.remove();
                }

				var ratings = $(".rating");
				if (ratings.length > 0) ratingStars(ratings);
				function ratingStars(stars) {
					$.each(stars, function(i, obj) {
                        var field = $(this).closest(".form-group").find(".rating-value");
						var tgt = $(obj);
						tgt.html("");
						var rating = FLUIGC.stars(tgt, { value: field.val() });
                        rating.on("click", function(o) {
                            field.val($(this).index() + 1);
                        });
					});
				}

				$.each($("[data-date]"), function(i, o) {
                    var id = $(o).attr("id");
					FLUIGC.calendar("#" + id);
				});

				$(document).ready(function() {
					$.each($("[data-date]"), function(i, o) {
	                    var id = $(o).attr("id");
	                    if($("#" + id).attr("readonly")) {
	                    	$("#" + id).data('DateTimePicker').disable();
	                    }
					});

					var minDate = new Date();
					

					FLUIGC.calendar('.calendar-date', {
						language: 'pt-br',
					    pickDate: true,
					    pickTime: false,
					    minDate: minDate
					});					

					$("#select_midia").on("change",function() {
						
						var opcao 			 = $(this).val();
						var tipo_peca 		 = $("#select_tipo_peca");
						var tipo_peca_opcoes = [];

						if(opcao === "")
							tipo_peca_opcoes.push("<option value=''>Selecione</option>");
						else if(opcao == "FACEBOOK")
						{
							tipo_peca_opcoes.push("<option value=''>Selecione</option>");
							tipo_peca_opcoes.push("<option value='FEED'>Feed</option>");
							tipo_peca_opcoes.push("<option value='CARROSSEL'>Carrossel</option>");
							tipo_peca_opcoes.push("<option value='SLIDE SHOW'>Slide Show</option>");
							tipo_peca_opcoes.push("<option value='CANVAS'>Canvas</option>");
						}
						else if(opcao == "INSTAGRAM")
						{
							tipo_peca_opcoes.push("<option value=''>Selecione</option>");
							tipo_peca_opcoes.push("<option value='FEED'>Feed</option>");
							tipo_peca_opcoes.push("<option value='CARROSSEL'>Carrossel</option>");
							tipo_peca_opcoes.push("<option value='STORIES'>Stories</option>");
						}
						else if(opcao == "LINKEDIN")
						{
							tipo_peca_opcoes.push("<option value=''>Selecione</option>");
							tipo_peca_opcoes.push("<option value='FEED'>Feed</option>");
						}

						tipo_peca.html("").append(tipo_peca_opcoes);				

					});

					$("#select_aprovacao_peca").on("change",function(){
						var result = $(this).val();

						if(result == "NAO")
						{
							$("#refacao").show();
							$("#derivacao").hide();
							$("#txt_derivacao").hide();
							$("#select_derivacao").val("");
							$("#txt_derivacao_field").val("");
						}
						else
						{
							$("#refacao").hide();
							$("#derivacao").show();
						}
					});

					$("#select_derivacao").on("change",function(){
						var result = $(this).val();

						if(result == "SIM")
							$("#txt_derivacao").show();
						else
							$("#txt_derivacao").hide();
					});

					$("#sel_aprovacao_derivacao").on("change",function(){
						var result = $(this).val();
						if(result == "NAO")
							$("#derivacao_refacao").show();
						else
							$("#derivacao_refacao").hide();
					});

					$('#select_tipo_peca').on('change',function(){
						$('#texto_orientacao').val('').hide();
						$('#cards').hide();
						limpa_carrossel('#cards_table');
						var midia = $('#select_midia').val();
						var tipo_peca = $(this).val();
						if(tipo_peca == '')
							return false;
						else 
							campos_tipo_peca(midia,tipo_peca);
					});

					$('#urgencia').on('change',function(){
						var urgente = $(this).val();
						$('#txt_justificativa_urgencia').val('');
						if(urgente == 'SIM')
							$('#justificativa_urgencia').show();
						else
							$('#justificativa_urgencia').hide();
					});
				});
			</script>
		</body>
	</html>